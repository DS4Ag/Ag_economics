<!doctype html>
<html>
<head>
<meta charset="utf-8">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/4.0.0/github-markdown.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/default.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">
<link rel="stylesheet" href="file:///c:\Users\yagua\.vscode\extensions\goessner.mdmath-2.7.4\themes\default\style.css">

</head>
<body class="markdown-body">
<h2 dir="auto" id="forecasting-soybeans-prices">Forecasting Soybeans Prices</h2>
<h3 dir="auto" id="lab-requirements">Lab Requirements:</h3>
<ol dir="auto">
<li dir="auto">soybeans-prices-monthly.csv file: Contains average monthly soybean spot prices. <a href="./soybeans-prices-monthly.csv">Download</a></li>
<li dir="auto">CPI.csv file: Contains the Consumer Price Index (CPI), a measure of inflation. <a href="./CPI.csv">Download</a></li>
</ol>
<h3 dir="auto" id="background"><strong>Background</strong></h3>
<p dir="auto">In this lab, we will analyze the average monthly price of soybeans. We will apply univariate (one variable) time-series techniques to forecast soybeans prices into the future. As in the previous lab, the skills developed in this lab are readily transferable to other commodities.</p>
<hr dir="auto">
<h3 dir="auto" id="getting-started-data-preparation-and-exploration"><strong>Getting Started: Data Preparation and Exploration</strong></h3>
<h4 dir="auto" id="step-1-%E2%80%93-install-and-load-required-packages">Step 1 – Install and Load Required Packages</h4>
<p dir="auto">In this lab, we will use several R packages that are essential for time-series analysis and visualization:</p>
<ul dir="auto">
<li dir="auto"><strong><code>tseries</code></strong>: Provides tools for time-series data manipulation and statistical testing</li>
<li dir="auto"><strong><code>forecast</code></strong>: Offers functions for forecasting time-series models like ARIMA</li>
<li dir="auto"><strong><code>TTR</code></strong>: Contains technical trading rules, including moving averages</li>
<li dir="auto"><strong><code>ggplot2</code></strong>: A powerful package for creating elegant and customizable plots</li>
</ul>
<p dir="auto">Before proceeding, ensure these packages are installed and loaded into your R environment:</p>
<pre><code class="code-line language-r" dir="auto"><span class="hljs-comment"># Install necessary packages (only run if not already installed)</span>
packages <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;tseries&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;forecast&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;TTR&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;ggplot2&quot;</span><span class="hljs-punctuation">)</span>
installed <span class="hljs-operator">&lt;-</span> packages <span class="hljs-operator">%in%</span> installed.packages<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span>

<span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-built_in">any</span><span class="hljs-punctuation">(</span><span class="hljs-operator">!</span>installed<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span>
  install.packages<span class="hljs-punctuation">(</span>packages<span class="hljs-punctuation">[</span><span class="hljs-operator">!</span>installed<span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-comment"># Load the libraries</span>
library<span class="hljs-punctuation">(</span>tseries<span class="hljs-punctuation">)</span>
library<span class="hljs-punctuation">(</span>forecast<span class="hljs-punctuation">)</span>
library<span class="hljs-punctuation">(</span>TTR<span class="hljs-punctuation">)</span>
library<span class="hljs-punctuation">(</span>ggplot2<span class="hljs-punctuation">)</span>
</code></pre>
<blockquote dir="auto">
<p dir="auto"><em>Note:</em> The conditional installation example ensures that only missing packages are installed, which makes your script more efficient and repeatable by avoiding unnecessary installations.</p>
</blockquote>
<h4 dir="auto" id="step-2-%E2%80%93-data-import"><strong>Step 2 – Data import</strong></h4>
<p dir="auto">Open R and set up a working directory in a convenient location on your computer. This will be the folder where you save all datasets, graphs, and outputs for this lab.</p>
<pre><code class="code-line language-r" dir="auto"><span class="hljs-comment"># Set working directory (update the path as needed)</span>
setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;C:/Users/your_name/Documents/Lab2&quot;</span><span class="hljs-punctuation">)</span>
</code></pre>
<p dir="auto">Next, download the <code>soybeans-prices-monthly.csv</code> and and the <code>CPI.csv</code> workbooks from our course resources. Save both files into your working directory.</p>
<p dir="auto">Once the files are saved, load the datasets into R and preview their contents. For example:</p>
<pre><code class="code-line language-r" dir="auto"><span class="hljs-comment"># Load the datasets</span>
soybeans <span class="hljs-operator">&lt;-</span> read.csv<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;soybeans-prices-monthly.csv&quot;</span><span class="hljs-punctuation">)</span>
CPI <span class="hljs-operator">&lt;-</span> read.csv<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;CPI.csv&quot;</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Preview the data</span>
head<span class="hljs-punctuation">(</span>soybeans<span class="hljs-punctuation">)</span>
head<span class="hljs-punctuation">(</span>CPI<span class="hljs-punctuation">)</span>
</code></pre>
<p dir="auto">This code will load the datasets into R and display the first few rows of each, allowing you to quickly verify their structure and contents.</p>
<p dir="auto">The soybeans data set contains the average spot price of soybeans by month for the period Jan 1, 1969 - July 1, 2020. Historical price data for many commodities can be found at <a href="https://www.macrotrends.net/charts/commodities">macrotrends.net</a>.</p>
<p dir="auto">The CPI data set is the monthly consumer price index published by the <a href="https://www.bls.gov/cpi/">Bureau of Labor Statistics (BLS)</a> and is a general measure of price inflation. We will use the CPI to convert nominal prices into inflation-adjusted, or &quot;real&quot; prices.</p>
<h4 dir="auto" id="step-3-%E2%80%93-create-date-variables-and-merge-data-frames"><strong>Step 3 – Create date variables and merge data frames</strong></h4>
<p dir="auto">Convert the <code>date</code> variables in the soybeans and CPI data frames into Date type using the <code>as.Date()</code> function. The original dates in our datasets are in the m/d/yyyy format so we tell R to read them as such:</p>
<pre><code class="code-line language-r" dir="auto"><span class="hljs-comment"># Convert date variables and merge</span>
soybeans<span class="hljs-operator">$</span>date <span class="hljs-operator">&lt;-</span> as.Date<span class="hljs-punctuation">(</span>soybeans<span class="hljs-operator">$</span>date<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;%m/%d/%Y&quot;</span><span class="hljs-punctuation">)</span>
CPI<span class="hljs-operator">$</span>date <span class="hljs-operator">&lt;-</span> as.Date<span class="hljs-punctuation">(</span>CPI<span class="hljs-operator">$</span>date<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;%m/%d/%Y&quot;</span><span class="hljs-punctuation">)</span>
</code></pre>
<p dir="auto">By default, R stores dates in the yyyy-mm-dd format. Double check that the dates have been converted properly, then merge the soybeans and CPI data frames by date:</p>
<pre><code class="code-line language-r" dir="auto">head<span class="hljs-punctuation">(</span>soybeans<span class="hljs-punctuation">)</span>
head<span class="hljs-punctuation">(</span>CPI<span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Merge datasets</span>
soybeans <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>soybeans<span class="hljs-punctuation">,</span> CPI<span class="hljs-punctuation">,</span> by<span class="hljs-operator">=</span><span class="hljs-string">&quot;date&quot;</span><span class="hljs-punctuation">)</span>
head<span class="hljs-punctuation">(</span>soybeans<span class="hljs-punctuation">)</span>
</code></pre>
<h4 dir="auto" id="step-4-%E2%80%93-convert-nominal-price-to-real-price"><strong>Step 4 – Convert nominal price to real price</strong></h4>
<p dir="auto">The soybean prices are currently in nominal terms, meaning they don't account for inflation. To make these prices comparable over time, we need to &quot;deflate&quot; the nominal soybean prices using the Consumer Price Index (CPI). Create a new variable called <code>price_real</code> using the following formula:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mtext>Real Price</mtext><mi>t</mi></msub><mo>=</mo><mfrac><msub><mtext>Nominal Price</mtext><mi>t</mi></msub><mrow><msub><mtext>CPI</mtext><mi>t</mi></msub><mi mathvariant="normal">/</mi><mn>100</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex"> \text{Real Price}_t = \frac{\text{Nominal Price}_t}{\text{CPI}_t/100} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">Real Price</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.30744em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">CPI</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/100</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">Nominal Price</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></eqn></section></math>
<p dir="auto">Where:</p>
<ul dir="auto">
<li dir="auto"><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>Nominal Price</mtext><mi>t</mi></msub></mrow><annotation encoding="application/x-tex"> \text{Nominal Price}_t </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">Nominal Price</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq> is the price at time  in current dollars.</li>
<li dir="auto"><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>CPI</mtext></mrow><annotation encoding="application/x-tex"> \text{CPI} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord text"><span class="mord">CPI</span></span></span></span></span></eq> is the Consumer Price Index at time <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex"> t </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span></eq>.</li>
<li dir="auto">Dividing <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>CPI</mtext></mrow><annotation encoding="application/x-tex"> \text{CPI} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord text"><span class="mord">CPI</span></span></span></span></span></eq> by 100 normalizes it, as the CPI is typically indexed to 100 in a base year.</li>
<li dir="auto">This formula converts the nominal price into the real price, adjusted for inflation, so that you can compare it to prices from different years in constant terms.</li>
</ul>
<p dir="auto">This process allows you to determine the real value of the price, reflecting its purchasing power in the base year.</p>
<pre><code class="code-line language-r" dir="auto"><span class="hljs-comment"># Your task: Create a new variable, `price_real`, for real soybean prices using the provided formula</span>

</code></pre>
<h4 dir="auto" id="step-5-%E2%80%93-visualize-soybeans-prices-over-time"><strong>Step 5 – Visualize soybeans prices over time</strong></h4>
<p dir="auto">Using <code>ggplot()</code>, graph the trends in nominal and real soybean prices over time. You can create two separate graphs, or try to graph both series in one plot using faceting with the <code>par()</code> function (introduced later in <strong>Step 8</strong>). Additionally, you are encouraged to customize your <code>ggplot()</code> graph as needed. If you need a refresher on <code>ggplot()</code>, refer to the previous lab for more guidance.</p>
<pre><code class="code-line language-r" dir="auto"><span class="hljs-comment"># Your task: Plot nominal and real prices over time with `ggplot()`</span>

</code></pre>
<p dir="auto">Save the graph(s) in your working directory. You will need this for your module homework assignment.</p>
<p dir="auto"><em>What do you notice about the trends in nominal vs. real soybeans prices? Why does adjusting for inflation change the series so dramatically? In real terms, what decade was the best time to be a soybean farmer? What was the most volatile period?</em></p>
<hr dir="auto">
<h3 dir="auto" id="time-series-decomposition-and-smoothing"><strong>Time-Series Decomposition and Smoothing</strong></h3>
<h4 dir="auto" id="step-6-%E2%80%93-establishing-a-time-series"><strong>Step 6 – Establishing a time-series</strong></h4>
<p dir="auto">We can specify a data frame as a time-series object in R. Time-series objects are vectors or matrices where each observation is timestamped, meaning each row represents a value at a specific point in time. R has many useful packages and tools for analyzing time-series data. To establish a time-series of nominal prices, we use the <code>ts()</code> function. The start, end, and frequency arguments will vary depending on the type of time series. In our case, we have monthly data observed between Jan, 1969 and July, 2020. Fill in the following <code>ts()</code> function with the appropriate arguments shown in brackets.</p>
<pre><code class="code-line language-r" dir="auto"><span class="hljs-comment"># Your task: Set nominal prices as a time series. Replace the placeholders (including the brackets) with the appropriate arguments.</span>
price.ts <span class="hljs-operator">&lt;-</span> ts<span class="hljs-punctuation">(</span><span class="hljs-punctuation">[</span>variable<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> start<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">[</span>start year<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">[</span>start month<span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> end<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">[</span>end year<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">[</span>end month<span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> frequency<span class="hljs-operator">=</span><span class="hljs-punctuation">[</span>frequency<span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span>
</code></pre>
<h4 dir="auto" id="step-7-%E2%80%93-decompose-the-time-series"><strong>Step 7 – Decompose the time-series</strong></h4>
<p dir="auto">Now that we have our data in a time-series object, we can analyze the components of the time series. A time-series is made up of three main components: trend, seasonal, and random noise. The <strong>trend</strong> is the long-term trajectory of the data series. The <strong>seasonal</strong> component captures patterns in the data that repeat every year (e.g. an increase in flower sales every February before Valentines Day). After the trend and seasonality have been accounted for, all that should be left in the time-series are unpredictable <strong>random</strong> fluctuations (noise).</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mtext>Price</mtext><mi>t</mi></msub><mo>=</mo><mtext>Trend</mtext><mo>+</mo><mtext>Seasonal</mtext><mo>+</mo><mtext>Random</mtext></mrow><annotation encoding="application/x-tex"> \text{Price}_t = \text{Trend} + \text{Seasonal} + \text{Random} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">Price</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord text"><span class="mord">Trend</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord text"><span class="mord">Seasonal</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord text"><span class="mord">Random</span></span></span></span></span></span></eqn></section></math>
<p dir="auto">We can use the <code>decompose()</code> function in R to investigate these three components. The <code>type=&quot;additive&quot;</code> option tells R that the time-series is additive as opposed to multiplicative, meaning it is constructed as follows:</p>
<pre><code class="code-line language-r" dir="auto"><span class="hljs-comment"># Decompose nominal price time-series</span>
price_components <span class="hljs-operator">&lt;-</span> decompose<span class="hljs-punctuation">(</span>price.ts<span class="hljs-punctuation">,</span> type<span class="hljs-operator">=</span><span class="hljs-string">&quot;additive&quot;</span><span class="hljs-punctuation">)</span>
plot<span class="hljs-punctuation">(</span>price_components<span class="hljs-punctuation">)</span>
price_components<span class="hljs-operator">$</span>figure
</code></pre>
<p dir="auto">The seasonal components, which are stored as <code>figure</code> in the <code>price_components</code> object in order of month, tell us the average difference between prices and their overall trend for each month. <em>What months have the largest (positive and negative) seasonal effects? What explains the seasonality in the price of soybeans?</em> Think about the underlying economics. Recall what we observed with the stock-to-use ratio (SUR) and corn prices in the previous lab.</p>
<h4 dir="auto" id="step-8-%E2%80%93-data-smoothing"><strong>Step 8 – Data smoothing</strong></h4>
<p dir="auto">We will now investigate the overall trend in the data. Because the trend in soybeans prices does not follow a clear upward or downward trend over time, estimating a linear time trend  would not be helpful. Instead, we can use one of several &quot;data smoothing&quot; techniques.</p>
<h5 dir="auto" id="seasonal-adjustment"><strong>Seasonal Adjustment</strong></h5>
<p dir="auto">Seasonality can obscure our ability to compare price changes from month to month. For example, if the price rises between July and August, we cannot easily tell how much of this change is due to typical seasonal fluctuations versus other factors, such as changes in supply or demand. To account for seasonality, we will <strong>seasonally adjust</strong> the data.</p>
<p dir="auto">We can create a seasonally adjusted time series by subtracting out the seasonality, which is stored as &quot;seasonal&quot; for each observation. Plot the seasonally adjusted time-series using <code>plot.ts()</code> and save the graph to your working directory.</p>
<pre><code class="code-line language-r" dir="auto"><span class="hljs-comment"># Create a seasonally adjusted time-series</span>
price_sa.ts <span class="hljs-operator">&lt;-</span> price.ts <span class="hljs-operator">-</span> price_components<span class="hljs-operator">$</span>seasonal

<span class="hljs-comment"># Your task: Plot the seasonally adjusted time-series using `plot.ts()`.</span>
<span class="hljs-comment"># The `plot.ts()` function is specifically for time-series objects and works similarly to the `plot()` function.</span>
plot.ts<span class="hljs-punctuation">(</span><span class="hljs-punctuation">[</span>time series<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> main<span class="hljs-operator">=</span><span class="hljs-string">&quot;Soybeans Prices (Seasonally Adjusted) Over Time&quot;</span><span class="hljs-punctuation">,</span> xlab<span class="hljs-operator">=</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span> ylab<span class="hljs-operator">=</span><span class="hljs-string">&quot;Nominal Price ($)&quot;</span><span class="hljs-punctuation">)</span>
</code></pre>
<p dir="auto">You will notice from the graph that the seasonally adjusted data is not significantly different from the original data. This is because of the high frequency of the data but also because there are cycles in the price of soybeans that span multiple months and years. Seasonally adjusting the data will not smooth over these cycles.</p>
<h5 dir="auto" id="simple-moving-average-sma"><strong>Simple Moving Average (SMA)</strong></h5>
<p dir="auto">Another commonly used data smoothing technique is the <strong>Simple Moving Average (SMA)</strong>. The SMA smooths out short-term fluctuations by averaging a set number of data points over time. The formula for the SMA is:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mtext>SMA</mtext><mi>t</mi></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><msub><mtext>Price</mtext><mi>t</mi></msub><mo>+</mo><mo>…</mo><mo>+</mo><msub><mtext>Price</mtext><mrow><mi>t</mi><mo>−</mo><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mi>n</mi></mfrac></mrow><annotation encoding="application/x-tex">
\text{SMA}_t(n) = \frac{\text{Price}_t + \ldots + \text{Price}_{t - n + 1}}{n}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">SMA</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">Price</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord text"><span class="mord">Price</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></eqn></section></math>
<p dir="auto">In this formula:</p>
<ul dir="auto">
<li dir="auto"><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex"> n </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span></eq> is the &quot;order&quot; of the moving average, or the number of periods to average.</li>
<li dir="auto">For example, an SMA with <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex"> n = 3 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span></eq> would take the average of the current month's price, the price from the previous month, and the price from two months ago.</li>
</ul>
<p dir="auto">The higher the order of the SMA, the more the fluctuations in the data are smoothed out. We will experiment with different SMA orders (3, 12, and 48 months) and compare the results graphically.</p>
<p dir="auto">Use the <code>SMA()</code> function from the <strong>TTR</strong> package to calculate these moving averages, and then visualize each SMA using the <code>plot.ts()</code> function. We'll arrange the plots in a 3-row layout for easy comparison.</p>
<pre><code class="code-line language-r" dir="auto"><span class="hljs-comment"># Your task: Take a 3-, 12-, and 48-month simple moving average of price using the `SMA()` function below (arguments in brackets).</span>
price_sma3 <span class="hljs-operator">&lt;-</span> SMA<span class="hljs-punctuation">(</span><span class="hljs-punctuation">[</span>time series<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> n<span class="hljs-operator">=</span><span class="hljs-punctuation">[</span>order<span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span> <span class="hljs-comment"># 3-month simple moving average</span>
<span class="hljs-punctuation">[</span>name<span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> SMA<span class="hljs-punctuation">(</span><span class="hljs-punctuation">[</span>time series<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> n<span class="hljs-operator">=</span><span class="hljs-punctuation">[</span>order<span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span>    <span class="hljs-comment"># 12-month simple moving average</span>
<span class="hljs-punctuation">[</span>name<span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> SMA<span class="hljs-punctuation">(</span><span class="hljs-punctuation">[</span>time series<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> n<span class="hljs-operator">=</span><span class="hljs-punctuation">[</span>order<span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span>    <span class="hljs-comment"># 48-month simple moving average</span>

<span class="hljs-comment"># Graph each moving average series in a separate graph using `plot.ts()`. You can use the `par(mfrow=c([# of rows], [# of columns]))` command to tell R to group the three graphs together.</span>
par<span class="hljs-punctuation">(</span>mfrow<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># Arrange plots in 3 rows</span>
<span class="hljs-comment"># Example: Plot the 3-month moving average</span>
plot.ts<span class="hljs-punctuation">(</span><span class="hljs-punctuation">[</span>time series<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> main<span class="hljs-operator">=</span><span class="hljs-string">&quot;Soybeans Price - 3 Month SMA&quot;</span><span class="hljs-punctuation">,</span> xlab<span class="hljs-operator">=</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span> ylab<span class="hljs-operator">=</span><span class="hljs-string">&quot;SMA Price ($)&quot;</span><span class="hljs-punctuation">)</span>
<span class="hljs-comment"># Your task: Plot the 12-month moving average</span>

<span class="hljs-comment"># Your task: Plot the 48-month moving average</span>

par<span class="hljs-punctuation">(</span>mfrow<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># Reset to default layout</span>
</code></pre>
<p dir="auto"><em>Save the graphs. What do you notice about the data as the number of months included in the SMA increases? What would a SMA of order 619 (the total number of months) look like? If you wanted to predict the price of soybeans next month, what order SMA would you use? What if you wanted to predict prices over the next two years?</em></p>
<hr dir="auto">
<h3 dir="auto" id="ensuring-stationarity"><strong>Ensuring Stationarity</strong></h3>
<h4 dir="auto" id="step-9-%E2%80%93-stationarity"><strong>Step 9 – Stationarity</strong></h4>
<p dir="auto">A major issue in forecasting is whether the time-series is &quot;stationary&quot; or &quot;non-stationary.&quot; <strong>Stationarity</strong> means that the mean and variance of the series does not change over time. A <strong>non-stationary</strong> time-series cannot be reliably forecasted because its underlying statistical properties change with time. If the series has an upward trend, the sample mean will increase over time, and you will consistently underestimate the mean of the series in future periods. In other words, a time-series with a trend or seasonality cannot be stationary and should not be forecasted. If you have a non-stationary time-series, you must convert it to a stationary time series before you can forecast with it.</p>
<p dir="auto">Return to the graph of the soybeans price time-series components using <code>plot(price_components)</code> in <strong>Step 7</strong>. Clearly, the price of soybeans is non-stationary as it contains a distinct time trend and seasonality. To convert the non-stationary series into a stationary one, we will take the first difference. In other words, we want to produce the following:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mtext>Price</mtext><mi>t</mi></msub><mo>=</mo><msub><mtext>Price</mtext><mi>t</mi></msub><mo>−</mo><msub><mtext>Price</mtext><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">
\Delta \text{Price}_t = \text{Price}_t - \text{Price}_{t-1}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord text"><span class="mord">Price</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">Price</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord text"><span class="mord">Price</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span></span></eqn></section></math>
<p dir="auto">which can be done using the <code>diff()</code> function in R. This is the month-to-month change in soybeans prices. Graph the differenced series with <code>plot.ts()</code> and see if it looks stationary.</p>
<pre><code class="code-line language-r" dir="auto"><span class="hljs-comment"># Take the first difference of the monthly soybeans price time-series using the `diff()` function.</span>
price_diff.ts <span class="hljs-operator">&lt;-</span> diff<span class="hljs-punctuation">(</span>price.ts<span class="hljs-punctuation">,</span> differences<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Your task: Graph the differenced time-series using `plot.ts()`</span>

</code></pre>
<p dir="auto">The first differenced series should look like white noise around a constant mean (zero in this case). However, the variability of the series changes over time. For example, between about 2005 and 2015, the amplitude of monthly price changes becomes visibly larger (higher highs and lower lows). Because stationarity requires both a constant mean and a constant variance, we need to transform the data once more.</p>
<p dir="auto">A common method for stabilizing the variance of a time-series is using logs. Take the natural log soybeans prices, then take the first difference and graph it. We will denote this new series <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mtext>Price</mtext><mo stretchy="true">~</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\widetilde{\text{Price}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.09333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94333em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord text"><span class="mord">Price</span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width='100%' height='0.26em' viewBox='0 0 600 260' preserveAspectRatio='none'><path d='M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z'/></svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>.</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mover accent="true"><mtext>Price</mtext><mo stretchy="true">~</mo></mover><mi>t</mi></msub><mo>=</mo><mi>ln</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mtext>Price</mtext><mi>t</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mi>ln</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mtext>Price</mtext><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
\widetilde{\text{Price}}_t = \ln(\text{Price}_t) - \ln(\text{Price}_{t-1})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.09333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94333em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord text"><span class="mord">Price</span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width='100%' height='0.26em' viewBox='0 0 600 260' preserveAspectRatio='none'><path d='M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z'/></svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">ln</span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">Price</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">ln</span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">Price</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></eqn></section></math>
<pre><code class="code-line language-r" dir="auto"><span class="hljs-comment"># Your task: Log-transform the soybeans price time-series using the `log()` function.</span>
<span class="hljs-comment"># This helps to stabilize variance and make the data more suitable for analysis.</span>
log_price.ts <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">log</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">[</span>time series<span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Your task: Take the first difference of the log-transformed soybeans price time-series using the `diff()` function.</span>
<span class="hljs-comment"># This essentially calculates the month-over-month percentage change. (*Why is this the case?*)</span>
log_price_diff.ts <span class="hljs-operator">&lt;-</span> diff<span class="hljs-punctuation">(</span><span class="hljs-punctuation">[</span>time series<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> differences<span class="hljs-operator">=</span><span class="hljs-punctuation">[</span>number of times to difference<span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Your task: Plot the log differenced time-series using the `plot.ts()` function. Change the title to &quot;Month-over-Month % Change in Soybeans Prices Over Time&quot;, x axis lable to &quot;&quot;, and y axis lable to &quot;% Price Change&quot;</span>

</code></pre>
<p dir="auto">Differences in logs are approximate to percent differences, so the series we just made is the month-to-month <strong>percent change</strong> in nominal soybeans prices. Another way of saying this is &quot;percent returns&quot; in soybeans. Analysts and traders use historical percent returns to predict when commodity prices will rise or fall. Looking at the graph, the variance of the series appears much more stable over time than before. Now that we have a stationary series, we can move on to modeling and forecasting.</p>
<hr dir="auto">
<h3 dir="auto" id="forecasting-and-model-evaluation"><strong>Forecasting and Model Evaluation</strong></h3>
<h4 dir="auto" id="step-10-%E2%80%93-auto-regressive-model"><strong>Step 10 – Auto-regressive model</strong></h4>
<p dir="auto">Commodities traders work with a lot of complex data and statistics but their basic objective is simple: <strong>buy low, sell high</strong>. In other words, traders want to anticipate future price changes — buying on the dips and selling at the peak. While there are many forecasting techniques, we will focus on the <strong>auto-regressive (AR) model</strong>.</p>
<p dir="auto">An <strong>AR model</strong> uses <strong>linear regression</strong> on past values of a time series (i.e., a linear combination of its past values) to predict its current value. The <strong>order</strong> of the AR model determines how many previous time periods are used to predict the current value. For example, an AR(n) model uses the last <strong>n</strong> observations to forecast the current value.</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mover accent="true"><mover accent="true"><mtext>Price</mtext><mo stretchy="true">~</mo></mover><mo>^</mo></mover><mi>t</mi></msub><mo>=</mo><mi>α</mi><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mover accent="true"><mtext>Price</mtext><mo stretchy="true">~</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><msub><mover accent="true"><mtext>Price</mtext><mo stretchy="true">~</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>β</mi><mi>n</mi></msub><msub><mover accent="true"><mtext>Price</mtext><mo stretchy="true">~</mo></mover><mrow><mi>t</mi><mo>−</mo><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
\hat{\widetilde{\text{Price}}}_t = \alpha + \beta_1 \widetilde{\text{Price}}_{t-1} + \beta_2 \widetilde{\text{Price}}_{t-2} + \dots + \beta_n \widetilde{\text{Price}}_{t-n}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3567699999999998em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.20677em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94333em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord text"><span class="mord">Price</span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width='100%' height='0.26em' viewBox='0 0 600 260' preserveAspectRatio='none'><path d='M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z'/></svg></span></span></span></span></span></span></span><span style="top:-3.51233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.151661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94333em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord text"><span class="mord">Price</span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width='100%' height='0.26em' viewBox='0 0 600 260' preserveAspectRatio='none'><path d='M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z'/></svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.151661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94333em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord text"><span class="mord">Price</span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width='100%' height='0.26em' viewBox='0 0 600 260' preserveAspectRatio='none'><path d='M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z'/></svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.151661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94333em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord text"><span class="mord">Price</span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width='100%' height='0.26em' viewBox='0 0 600 260' preserveAspectRatio='none'><path d='M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z'/></svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28055599999999997em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span></span></eqn></section></math>
<p dir="auto">Where:</p>
<ul dir="auto">
<li dir="auto"><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mover accent="true"><mtext>Price</mtext><mo stretchy="true">~</mo></mover><mo>^</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex"> \hat{\widetilde{\text{Price}}}_t </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3567699999999998em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.20677em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94333em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord text"><span class="mord">Price</span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width='100%' height='0.26em' viewBox='0 0 600 260' preserveAspectRatio='none'><path d='M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z'/></svg></span></span></span></span></span></span></span><span style="top:-3.51233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq> is the <strong>predicted</strong> value for <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mtext>Price</mtext><mo stretchy="true">~</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex"> \widetilde{\text{Price}}_t </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.09333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94333em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord text"><span class="mord">Price</span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width='100%' height='0.26em' viewBox='0 0 600 260' preserveAspectRatio='none'><path d='M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z'/></svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>,</li>
<li dir="auto"><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex"> \alpha </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span></eq> is the <strong>intercept</strong>,</li>
<li dir="auto"><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>β</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>β</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex"> \beta_1, \beta_2, \dots, \beta_n </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq> are the <strong>auto-regression coefficients</strong>,</li>
<li dir="auto"><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mtext>Price</mtext><mo stretchy="true">~</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mover accent="true"><mtext>Price</mtext><mo stretchy="true">~</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>2</mn></mrow></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mover accent="true"><mtext>Price</mtext><mo stretchy="true">~</mo></mover><mrow><mi>t</mi><mo>−</mo><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex"> \widetilde{\text{Price}}_{t-1}, \widetilde{\text{Price}}_{t-2}, \dots, \widetilde{\text{Price}}_{t-n} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.151661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94333em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord text"><span class="mord">Price</span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width='100%' height='0.26em' viewBox='0 0 600 260' preserveAspectRatio='none'><path d='M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z'/></svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94333em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord text"><span class="mord">Price</span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width='100%' height='0.26em' viewBox='0 0 600 260' preserveAspectRatio='none'><path d='M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z'/></svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94333em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord text"><span class="mord">Price</span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width='100%' height='0.26em' viewBox='0 0 600 260' preserveAspectRatio='none'><path d='M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z'/></svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28055599999999997em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span></eq> are the lagged values (previous months),</li>
<li dir="auto">We can also denote the <strong>error term</strong> at time <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex"> t </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span></eq>—the difference between the actual value and the model's predication — as <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mi>t</mi></msub><mo>=</mo><msub><mover accent="true"><mtext>Price</mtext><mo stretchy="true">~</mo></mover><mi>t</mi></msub><mo>−</mo><msub><mover accent="true"><mover accent="true"><mtext>Price</mtext><mo stretchy="true">~</mo></mover><mo>^</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex"> \epsilon_t = \widetilde{\text{Price}}_t - \hat{\widetilde{\text{Price}}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.09333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94333em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord text"><span class="mord">Price</span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width='100%' height='0.26em' viewBox='0 0 600 260' preserveAspectRatio='none'><path d='M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z'/></svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.3567699999999998em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.20677em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94333em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord text"><span class="mord">Price</span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width='100%' height='0.26em' viewBox='0 0 600 260' preserveAspectRatio='none'><path d='M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z'/></svg></span></span></span></span></span></span></span><span style="top:-3.51233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>.</li>
</ul>
<p dir="auto">Remember from above that <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mtext>Price</mtext><mo stretchy="true">~</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex"> \widetilde{\text{Price}}_t </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.09333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94333em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord text"><span class="mord">Price</span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width='100%' height='0.26em' viewBox='0 0 600 260' preserveAspectRatio='none'><path d='M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z'/></svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq> is the log difference in monthly prices, or <strong>monthly percent returns</strong>. What this equation tells us is that the percent return on soybeans this month is a function of the percent returns from last month, two months ago, and so on, up to month <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>−</mo><mi>n</mi></mrow><annotation encoding="application/x-tex"> t - n </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69841em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span></eq>.</p>
<p dir="auto">The <strong>intercept</strong>, <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex"> \alpha </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span></eq>, represents the baseline level of the series when all lagged terms are zero. It captures the average value of the time series (after any transformations like differencing) that isn't explained by past values.</p>
<p dir="auto">The <strong>auto-regression coefficients</strong>, the <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex"> \beta </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span></eq>'s, represent the estimated effects of previous price changes on the current price change — in other words, how past returns influence today's return.</p>
<p dir="auto">The choice of the AR model's <strong>order</strong>, <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex"> n </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span></eq>, is mostly an empirical question and should be guided by the characteristics of your specific time series. For simplicity, we'll fit an <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>AR</mtext><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> \text{AR}(3) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">AR</span></span><span class="mopen">(</span><span class="mord">3</span><span class="mclose">)</span></span></span></span></eq> model using the <code>ar()</code> function:</p>
<pre><code class="code-line language-r" dir="auto"><span class="hljs-comment"># Run auto-regressive model with 3 lags (AR(3))</span>
ar <span class="hljs-operator">&lt;-</span> ar<span class="hljs-punctuation">(</span>log_price_diff.ts<span class="hljs-punctuation">,</span> order.max<span class="hljs-operator">=</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span>
ar
checkresiduals<span class="hljs-punctuation">(</span>ar<span class="hljs-punctuation">,</span> lag.max<span class="hljs-operator">=</span><span class="hljs-number">60</span><span class="hljs-punctuation">)</span>
</code></pre>
<p dir="auto">Using <code>ar()</code>, you can view the estimated auto-regression coefficients — the <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex"> \beta </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span></eq>'s in the equation above — which quantify how previous monthly returns impact the current month's return.</p>
<p dir="auto"><em>Of the three lags, which has the greatest impact on current percent returns?</em></p>
<p dir="auto">The <code>checkresiduals()</code> command shows a time series of the auto-regression errors, <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex"> \epsilon_t </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>. As mentioned in the previous lab, we want to make sure there is not a noticeable pattern in the error term over time, i.e., we want to check for any remaining auto-correlation in the errors.</p>
<p dir="auto">The bottom left pane shows the <strong>auto-correlation function (ACF)</strong> of the residuals from our <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>R</mi><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> AR(3) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord">3</span><span class="mclose">)</span></span></span></span></eq> model. It displays the correlation between the current error term and error terms from lags 1 through 60 — in other words, how strongly each residual is correlated with residuals from previous time steps. You can change the number of lags examined using the <code>lag.max</code> option.</p>
<p dir="auto">Ideally, all bars in the ACF plot should fall within the blue significance bounds, indicating no statistically significant autocorrelations. If your model is good, the residuals <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex"> \epsilon_t </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq> should look like <strong>random noise</strong>, showing no significant correlation with past values — as tested by the ACF. This would suggest that the model has effectively captured all the predictable patterns in the data.</p>
<p dir="auto">In our case, there does appear to be some remaining auto-correlation (e.g., at the 12th lag). You can adjust the order of the AR model <code>order.max</code> and see how this affects the ACF.</p>
<p dir="auto">To keep things simple, however, we will continue with the <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>R</mi><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> AR(3) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord">3</span><span class="mclose">)</span></span></span></span></eq>.</p>
<h4 dir="auto" id="step-11-%E2%80%93-forecasting"><strong>Step 11 – Forecasting</strong></h4>
<p dir="auto">We can forecast future soybeans percent returns with the <code>forecast()</code> function in R. We will predict percent returns for soybeans six months after the end of the series (Aug 2020-Jan 2021) and graph our forecast with the 36 most recent months of data.</p>
<pre><code class="code-line language-r" dir="auto"><span class="hljs-comment"># Forecast prices 6 months into the future based on the AR(3) model</span>
forecast <span class="hljs-operator">&lt;-</span> forecast<span class="hljs-punctuation">(</span>ar<span class="hljs-punctuation">,</span> h<span class="hljs-operator">=</span><span class="hljs-number">6</span><span class="hljs-punctuation">)</span>
forecast
autoplot<span class="hljs-punctuation">(</span>forecast<span class="hljs-punctuation">,</span> include<span class="hljs-operator">=</span><span class="hljs-number">36</span><span class="hljs-punctuation">,</span> xlab<span class="hljs-operator">=</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span> ylab<span class="hljs-operator">=</span><span class="hljs-string">&quot;Soybeans price - monthly % returns&quot;</span><span class="hljs-punctuation">)</span>
</code></pre>
<p dir="auto">Our predicted values are shown as the blue line in the <code>autoplot()</code> graph. The dark and light shaded areas represent the 80% and 95% <strong>confidence intervals</strong> around our predictions, respectively. These intervals reflect the <strong>uncertainty</strong> in our forecast: the wider the interval, the more uncertainty is present. For example, the 95% interval is wider than the 80% interval, reflecting the trade-off between <strong>confidence</strong> and <strong>precision</strong>.</p>
<p dir="auto">Technically, a 95% confidence interval means that if we were to repeat this forecasting process many times, <strong>95% of the resulting intervals would contain the true future value</strong>. It does not imply that there is a 95% probability (or chance) the true value falls within this one specific interval — the true value is fixed, and the interval is what varies. We construct the interval using a method designed to capture the true value with a specified level of confidence.</p>
<p dir="auto"><em>According to our forecast, when should we buy soybeans and when should we sell? Given the estimated range of values (both positive and negative), how confident would you be in your trading decision?</em></p>
<p dir="auto">Try forecasting with AR models of different orders. <em>Does your forecast change significantly?</em></p>
<p dir="auto">Look at the table below of actual prices and percent returns for Aug 2020 to Oct 2020. <em>How close are your predicted returns to actual returns for this period?</em></p>
<table dir="auto">
<thead dir="auto">
<tr dir="auto">
<th></th>
<th><strong>Soy price</strong></th>
<th><strong>Log soy price</strong></th>
<th><strong>% returns</strong></th>
</tr>
</thead>
<tbody dir="auto">
<tr dir="auto">
<td>Jul-20</td>
<td>8.94</td>
<td>2.19</td>
<td>-0.001</td>
</tr>
<tr dir="auto">
<td>Aug-20</td>
<td>9.01</td>
<td>2.20</td>
<td>0.008</td>
</tr>
<tr dir="auto">
<td>Sep-20</td>
<td>9.96</td>
<td>2.30</td>
<td>0.101</td>
</tr>
<tr dir="auto">
<td>Oct-20</td>
<td>10.55</td>
<td>2.36</td>
<td>0.057</td>
</tr>
</tbody>
</table>
<p dir="auto">While our <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>R</mi><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> AR(3) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord">3</span><span class="mclose">)</span></span></span></span></eq> model is fairly basic, more advanced forecasting techniques produce similarly wide prediction ranges. This is because commodity prices are famously hard to predict. If they could be predicted easily, we could become very rich trading soybeans.</p>

</body>
</html>